# rsyslog/rsyslog.conf
# Basic configuration
$ModLoad imuxsock  # provides support for local system logging
$ModLoad imklog    # provides kernel logging support

# Enable UDP syslog reception
$ModLoad imudp
$UDPServerRun 514
$UDPServerAddress 0.0.0.0

# Enable TCP syslog reception
$ModLoad imtcp
$InputTCPServerRun 514

# Set default permissions for all log files
$FileOwner root
$FileGroup root
$FileCreateMode 0644
$DirCreateMode 0755

# Log all messages to a central file
*.* /var/log/messages

# Forward logs to Splunk (optional - using HEC instead)
# *.* @@splunk:514

# Emergency messages to all users
*.emerg :omusrmsg:*

# Stop processing after logging
& stop